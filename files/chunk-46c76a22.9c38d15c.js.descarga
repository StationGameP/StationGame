(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46c76a22"],{"7f6c":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"battle",class:["battle_"+t.status,{opened:t.isOpened,isPanel:t.isPanel}]},[a("div",{staticClass:"battle__inner",on:{click:t.openBattle}},[a("button",{staticClass:"btn",on:{click:function(e){return e.stopPropagation(),t.showPopup.apply(null,arguments)}}},[a("span",[a("Icon",{attrs:{type:"icon-info"}})],1),a("div",{staticClass:"btn__game"},[a("Icon",{staticClass:"icon icon_active",attrs:{type:"icon-tourney"}}),a("span",[t._v(t._s(t.battle.name))])],1),a("div",{staticClass:"btn__prize"},[a("Icon",{staticClass:"icon",attrs:{type:"icon-dollar"}}),a("span",[t._v(t._s(t.battle.prizeUsdValue))])],1),a("div",{staticClass:"btn__duration"},[a("Icon",{staticClass:"icon",attrs:{type:"icon-clock"}}),a("span",[t._v(t._s(t.$formatMilliseconds(t.battle.duration,t.formatDuration(t.battle.duration))))])],1)]),a("div",{staticClass:"head"},[a("div",{staticClass:"head__time"},["ended"!==t.status?a("div",["coming"===t.status?a("span",{staticClass:"timer_text"},[t._v(t._s(t.$t("Start in")))]):t._e(),"active"===t.status?a("span",{staticClass:"timer_text"},[t._v(t._s(t.$t("Finish in"))+" ")]):t._e(),t._v(" "+t._s(t.$formatMilliseconds(t.timeout,t.formatDuration(t.timeout,!0," %s")))+" ")]):a("div")]),a("Icon",{staticClass:"icon-arrow",attrs:{type:"icon-arrow"}}),a("div",{staticClass:"status",class:"status_"+t.status},[a("span",[t._v(t._s(t.$t(t.status)))])])],1)]),t.isOpened?[t.hasWinners?a("div",{staticClass:"battle-table table-gamehistory"},[a("div",{staticClass:"battle-table__head"},[a("div",{staticClass:"battle-table__column"},[t._v(t._s(t.$t("Place")))]),a("div",{staticClass:"battle-table__column"},[t._v(t._s(t.$t("Player")))]),a("div",{staticClass:"battle-table__column"},[t._v(" "+t._s(t.$t(t.battleObj.type))+" ")]),a("div",{staticClass:"battle-table__column"},[t._v(t._s(t.$t("Prize")))])]),a("div",{staticClass:"battle-table__inner"},t._l(t.tenWinners,(function(e,s){return a("div",{key:s,staticClass:"battle-table__row",class:{sticky:e.name===t.currentUserName}},[a("div",{staticClass:"battle-table__row-inner"},[a("div",{staticClass:"battle-table__column"},[a("div",{staticClass:"number",class:{colors:e.place<=3}},[e.place<=3?a("Icon",{attrs:{type:"icon-battle-number"}}):t._e(),a("span",[t._v(t._s(e.place))])],1)]),a("div",{staticClass:"battle-table__column"},[a("div",{staticClass:"user"},[a("Avatar",{attrs:{level:e.lvl,id:e.avatarId,size:"medium"}}),a("span",[t._v(t._s(e.name))])],1)]),a("div",{staticClass:"battle-table__column"},[a("Currency",{attrs:{value:e.amount,currency:t.battle.prizeCurrency}})],1),a("div",{staticClass:"battle-table__column"},[a("div",{staticClass:"desktop"},[e.additionalAward?a("div",{staticClass:"currency_add"},[a("img",{attrs:{src:t.$iconCoinPath("btc"),alt:"btc"}}),a("div",{staticClass:"awards"},[a("span",{staticClass:"award_add",domProps:{innerHTML:t._s("+"+t.$currency(e.additionalAward,"#2DDC4B"))}}),a("span",{staticClass:"award",domProps:{innerHTML:t._s(t.$currency(e.award,"#2DDC4B"))}})])]):a("Currency",{attrs:{value:e.place<t.battleObj.winners.length+1?e.award:0,currency:t.battle.prizeCurrency,color1:"#2DDC4B"}})],1),a("div",{staticClass:"mobile"},[e.additionalAward>0?a("span",{staticClass:"small_perc",domProps:{innerHTML:t._s("+"+t.$currency(e.additionalAward,"#2DDC4B","#2DDC4B"))}}):t._e(),a("span",{staticClass:"big_perc"},[t._v(t._s(t.battleObj.winners.length+1>e.place?e.percent:0)+"%")])])])])])})),0),t.battleObj.winners.length?a("Pagination",{attrs:{defaultPage:t.currentPage,"page-change":t.handlePageChange,count:Math.ceil(t.battleObj.winners.length/10)}}):t._e()],1):[t.isLoading?a("div",{staticClass:"battle-loading"},[a("Spinner")],1):a("NoInformation")]]:t._e()],2)},i=[],n=a("2f62"),l={name:"Battle",components:{Currency:()=>a.e("chunk-00923253").then(a.bind(null,"a664")),Avatar:()=>a.e("chunk-002c17cf").then(a.bind(null,"28e7")),Spinner:()=>a.e("chunk-68c46248").then(a.bind(null,"1ff0")),NoInformation:()=>a.e("chunk-236373f8").then(a.bind(null,"412e")),Pagination:()=>a.e("chunk-48bad856").then(a.bind(null,"ecae"))},props:{isOpened:{type:Boolean,required:!0},battle:{type:Object,required:!0},isPanel:{type:Boolean}},watch:{isOpened(t){"active"===this.status&&t?this.timerActiveBattle=setInterval(()=>{this.$store.dispatch("battles/getBattle",this.battle._id),this.handlePageChange(1)},6e4):t||(clearInterval(this.timerActiveBattle),this.timerActiveBattle=null)}},data(){return{timer:null,timeout:0,timerActiveBattle:null,currentPage:1}},created(){this.updateTimer(),this.timer=setInterval(this.updateTimer,1e3)},mounted(){null!==this.$store.state.battles.startOpenBattle&&this.battle._id===this.$store.state.battles.startOpenBattle._id&&this.openBattle()},computed:{...Object(n["c"])({battleObj:"battles/battle",isLoading:"battles/isLoading"}),stickyWinner(){return this.$store.state.battles.me},tenWinners(){let t=[...this.battleObj.tenWinners];const e=t.some(t=>t.name===this.currentUserName);return!e&&this.stickyWinner&&t.push(this.stickyWinner),t},currentUserName(){return this.$store.state.user.username},hasWinners(){return!!this.battleObj.winners.length},status(){return this.battle.eventFinish<Date.now()?"ended":Date.now()<this.battle.eventStart?"coming":"active"}},methods:{...Object(n["b"])({getBattleInfo:"battles/getBattleInfo"}),handlePageChange(t){this.currentPage=t,this.$store.commit("battles/setPaginationPage",t)},async showPopup(){await this.getBattleInfo(this.battle._id),this.$store.commit("popups/show",{popup:"Battle"})},formatDuration(t,e=!1,a=""){let s=a.trim(),i=Math.floor(t/864e5);if(i>0)return e?"%Dd %h:%m:"+s:"%Dd";let n=t-24*i*60*6e4,l=Math.floor(n/36e5);return l>0?e?"%h:%m:"+s:"%hh":e?"%m:"+s:"%mm"},updateTimer(){if("coming"===this.status)this.timeout=this.$getTimeout(this.battle.eventStart);else{if("active"!==this.status)return;this.timeout=this.$getTimeout(this.battle.eventFinish)}},openBattle(){"coming"!==this.status&&(this.isOpened?this.$store.commit("battles/clearBattleObj"):this.$store.dispatch("battles/getBattle",this.battle._id),this.$emit("on-click",this.battle._id))}},destroyed(){clearInterval(this.timer),this.timer=null,this.timeout=0,clearInterval(this.timerActiveBattle),this.timerActiveBattle=null}},r=l,c=(a("ebc2"),a("2877")),o=Object(c["a"])(r,s,i,!1,null,"527a80e8",null);e["default"]=o.exports},"8b26":function(t,e,a){},ebc2:function(t,e,a){"use strict";a("8b26")}}]);